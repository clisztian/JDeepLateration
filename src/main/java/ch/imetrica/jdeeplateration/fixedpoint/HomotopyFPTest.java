package ch.imetrica.jdeeplateration.fixedpoint;


import java.util.Random;

import ch.imetrica.jdeeplateration.fixedpoint.util.Array;
import ch.imetrica.jdeeplateration.fixedpoint.util.Matrice;

import java.util.Calendar;



public class HomotopyFPTest {
	
	// creates a Matrice and a vector and solves the l1 min problem
	public static void test1(){
		double[][] m1 = {{0.74822998046875,-0.018707275390625,0.770477294921875,-0.301300048828125,0.4234619140625,0.034698486328125,-0.98284912109375,0.50823974609375,0.11822509765625,-0.134002685546875,-0.9786529541015625,-0.0358734130859375,-0.5497894287109375,0.0043792724609375,-0.9258270263671875,-0.72589111328125,0.3979034423828125,0.053955078125,0.9676055908203125,-0.4245758056640625,-0.1163330078125,0.4708099365234375,0.9666595458984375,0.34844970703125,-0.85369873046875,0.3964996337890625,0.696685791015625,0.37030029296875,-0.3074951171875,0.2125244140625,-0.212493896484375,-0.192535400390625,-0.7016754150390625,-0.9469451904296875,0.20281982421875,0.2757568359375,0.5254669189453125,0.8978118896484375,0.58477783203125,0.7363128662109375,0.524566650390625,0.0641632080078125,-0.344390869140625,0.9502716064453125,0.516204833984375,-0.072479248046875,0.7443389892578125,0.8804779052734375,0.272186279296875,-0.479095458984375,0.84393310546875,-0.0926971435546875,-0.8360595703125,-0.6998748779296875,-0.745086669921875,0.0166015625,0.9012298583984375,-0.1928253173828125,0.834381103515625,0.2212982177734375,-0.046112060546875,-0.7745819091796875,-0.8553924560546875,-0.6058349609375,-0.169647216796875,-0.108612060546875,-0.616729736328125,-0.582061767578125,0.881744384765625,-0.28662109375,-0.1219024658203125,0.09967041015625,0.10595703125,0.1441802978515625,0.1411285400390625,-0.3498382568359375,-0.45391845703125,-0.1351776123046875,-0.996612548828125,-0.30511474609375,-0.691131591796875,0.6587371826171875,0.1889801025390625,-0.238433837890625,-0.0272064208984375,-0.9095306396484375,0.837249755859375,0.980712890625,-0.787353515625,0.5501251220703125,0.9453277587890625,0.33856201171875,0.835723876953125,0.9848175048828125,0.478424072265625,-0.7617950439453125,-0.89251708984375,0.210418701171875,-0.01715087890625,-0.646881103515625},{-0.7625732421875,-0.9183807373046875,-0.062225341796875,0.79827880859375,0.2038421630859375,0.9960479736328125,-0.205963134765625,0.4974822998046875,0.714141845703125,0.2172088623046875,-0.3259124755859375,0.291839599609375,-0.9701385498046875,-0.676055908203125,0.044708251953125,0.81243896484375,0.6291961669921875,-0.27142333984375,-0.67498779296875,0.4316558837890625,0.2366485595703125,0.6530609130859375,0.3544921875,0.7107696533203125,0.618621826171875,-0.7874298095703125,-0.0780487060546875,0.677703857421875,-0.274688720703125,-0.6721343994140625,-0.856597900390625,-0.002655029296875,0.2533111572265625,0.0727691650390625,0.37799072265625,-0.3625030517578125,-0.489776611328125,0.7602996826171875,0.5834197998046875,-0.0124053955078125,0.5815887451171875,0.580657958984375,-0.462005615234375,0.55291748046875,0.23199462890625,0.926788330078125,0.1943359375,0.3256683349609375,0.7164459228515625,0.6776580810546875,-0.42010498046875,-0.2747039794921875,-0.2651824951171875,0.656951904296875,0.1227874755859375,-0.3958892822265625,-0.8687591552734375,-0.75543212890625,-0.943756103515625,0.229949951171875,0.6217803955078125,0.690399169921875,-0.3564453125,-0.6135711669921875,-0.1717376708984375,-0.935028076171875,0.3650665283203125,-0.227813720703125,0.2024383544921875,-0.0216064453125,0.9222564697265625,-0.265838623046875,0.043853759765625,-0.7908172607421875,0.9390869140625,0.035858154296875,0.7466888427734375,0.2066802978515625,0.57843017578125,0.840057373046875,0.65447998046875,-0.93475341796875,-0.057525634765625,-0.623443603515625,0.458953857421875,0.0163421630859375,0.08807373046875,-0.131072998046875,0.9475860595703125,0.743621826171875,0.7640228271484375,-0.7895355224609375,0.0867919921875,0.899017333984375,0.5648193359375,0.6076202392578125,-0.078582763671875,-0.9178466796875,0.095916748046875,0.9508819580078125},{0.5779266357421875,-0.7569122314453125,-0.04144287109375,0.0258331298828125,0.7778472900390625,0.9776763916015625,0.8871612548828125,0.8437347412109375,-0.300201416015625,-0.492462158203125,-0.7891082763671875,0.3491973876953125,-0.2277984619140625,0.2711181640625,0.960662841796875,0.5536041259765625,0.03582763671875,-2.13623046875E-4,0.40618896484375,-0.2536773681640625,-0.9157257080078125,0.91241455078125,-0.416900634765625,-0.1478729248046875,-0.7279052734375,-0.765594482421875,0.457489013671875,-0.7687530517578125,-0.1255340576171875,-0.36810302734375,0.7766265869140625,0.25994873046875,0.1889801025390625,-0.651153564453125,0.3662567138671875,-0.1171417236328125,0.1891937255859375,-0.15521240234375,0.66143798828125,0.99407958984375,0.2713775634765625,-0.4467926025390625,0.5949859619140625,0.983062744140625,0.8796539306640625,-0.98480224609375,0.6182708740234375,-0.9279937744140625,-0.6480712890625,-0.90972900390625,-0.4080352783203125,0.1748504638671875,-0.8022308349609375,0.206329345703125,0.5599212646484375,-0.0755767822265625,0.2009429931640625,-0.3175811767578125,-0.9932098388671875,-0.7576751708984375,0.2338714599609375,-0.95660400390625,-0.8991241455078125,-0.63232421875,-0.5225067138671875,-0.0577850341796875,-0.36370849609375,-0.3862457275390625,0.8595428466796875,-0.18414306640625,-0.0859832763671875,0.2880401611328125,0.95538330078125,0.7228851318359375,0.6393585205078125,0.1896514892578125,-0.659698486328125,0.9453887939453125,0.06353759765625,-0.1111602783203125,-0.56170654296875,0.8855133056640625,-0.939788818359375,0.5971221923828125,0.281707763671875,0.546356201171875,0.6031341552734375,-0.147552490234375,0.2779693603515625,-0.54058837890625,-0.80120849609375,-0.5277557373046875,-0.926788330078125,-0.6947021484375,0.2285614013671875,0.2684478759765625,-0.0901947021484375,0.6722259521484375,-0.1323699951171875,-0.12811279296875},{0.493804931640625,0.4057769775390625,-0.7265777587890625,0.6795196533203125,-0.6804962158203125,0.8264007568359375,0.0740203857421875,0.4166412353515625,0.6433868408203125,0.7255096435546875,-0.1623992919921875,0.0968170166015625,0.855194091796875,0.4984283447265625,0.166778564453125,-0.7335357666015625,-0.1359100341796875,0.0320281982421875,0.3370361328125,0.336181640625,-0.701141357421875,0.03759765625,-0.0135345458984375,0.5303955078125,0.8153839111328125,-0.5964202880859375,-0.7357940673828125,-0.4731292724609375,0.6113739013671875,0.840789794921875,0.0582427978515625,-0.787841796875,0.367401123046875,0.601898193359375,-0.5518951416015625,-0.8556976318359375,0.2649078369140625,-0.620269775390625,0.36639404296875,-0.7069854736328125,0.47607421875,0.6232147216796875,0.6030426025390625,0.418487548828125,-0.42303466796875,-0.542510986328125,-0.2504730224609375,0.0535125732421875,-0.29541015625,0.1542205810546875,0.4551239013671875,0.469512939453125,0.9601593017578125,0.670501708984375,-0.5443115234375,0.2357635498046875,-0.4450836181640625,-0.8405303955078125,-0.7644195556640625,-0.97808837890625,-0.4984283447265625,-0.44696044921875,0.8961639404296875,0.147674560546875,0.2735748291015625,-0.673095703125,0.829986572265625,-0.9508056640625,0.78594970703125,0.3803253173828125,0.1373291015625,0.310699462890625,-0.7042236328125,-0.402191162109375,0.3724212646484375,-0.799713134765625,-0.6232452392578125,-0.892852783203125,0.169403076171875,-0.2470703125,-0.008148193359375,-0.491851806640625,0.5735931396484375,0.3594512939453125,0.8690643310546875,0.4183502197265625,0.4912872314453125,-0.45135498046875,0.8802032470703125,-0.432647705078125,-0.4278717041015625,-0.8089141845703125,0.928497314453125,0.3677978515625,0.0504608154296875,-0.293701171875,-0.02935791015625,0.4016876220703125,-0.402069091796875,0.02117919921875},{-0.769927978515625,-0.417510986328125,0.0771026611328125,0.006256103515625,-0.5975799560546875,0.88818359375,0.2367095947265625,0.90679931640625,0.7112579345703125,0.5081939697265625,-0.1486358642578125,-0.1099853515625,0.0406646728515625,0.0061492919921875,0.5848541259765625,0.2452392578125,-0.946868896484375,0.6734161376953125,0.9429931640625,-0.997772216796875,0.1957550048828125,-0.36737060546875,-0.916473388671875,0.7745208740234375,-0.19635009765625,0.4479217529296875,-0.0377044677734375,0.4873809814453125,-0.870758056640625,0.0083160400390625,0.3212738037109375,0.316558837890625,-0.942596435546875,0.272796630859375,0.3614654541015625,-0.3575592041015625,0.5106964111328125,0.1007080078125,0.5939178466796875,-0.8852386474609375,0.10552978515625,0.838134765625,0.32550048828125,-0.972686767578125,-0.5106964111328125,-0.4093170166015625,0.5110626220703125,0.1175079345703125,0.970062255859375,0.1854095458984375,0.2915496826171875,-0.36572265625,-0.4554901123046875,-0.2904205322265625,-0.5617828369140625,-0.94085693359375,0.2368011474609375,0.2107086181640625,0.1358795166015625,0.2183380126953125,-0.22039794921875,0.65283203125,-0.936614990234375,-0.3099212646484375,-0.8993072509765625,-0.4545135498046875,0.567596435546875,-0.6100921630859375,-0.177642822265625,-0.202911376953125,-0.1224822998046875,0.00732421875,0.0377044677734375,0.2916107177734375,-0.2320404052734375,-0.4287109375,-0.0032196044921875,-0.5528717041015625,0.857666015625,-0.1626129150390625,-0.9824981689453125,0.586944580078125,0.8146209716796875,0.4187164306640625,0.9300689697265625,-0.660675048828125,-0.8581390380859375,0.622833251953125,0.6706695556640625,-0.521759033203125,-0.0704193115234375,-0.18865966796875,-0.7411956787109375,-0.3718109130859375,0.985107421875,0.764068603515625,0.3249053955078125,-0.922149658203125,0.090179443359375,-0.9912109375},{0.5984344482421875,0.5823211669921875,-0.2149658203125,0.36810302734375,-0.67620849609375,-0.5191802978515625,-0.957977294921875,-0.9210662841796875,-0.559906005859375,-0.2832794189453125,-0.533203125,-0.2442779541015625,0.542755126953125,0.4188385009765625,-0.7471160888671875,0.1973419189453125,0.1389923095703125,-0.4123077392578125,0.01593017578125,0.5785064697265625,-0.4842376708984375,0.12786865234375,-0.153167724609375,-0.0800933837890625,-0.3419036865234375,-0.0228729248046875,0.4483184814453125,0.8975830078125,-0.912872314453125,0.405609130859375,-0.942596435546875,-0.9695892333984375,-0.7684783935546875,0.6925201416015625,-0.9935150146484375,0.0753936767578125,0.0024566650390625,-0.6641998291015625,0.23907470703125,0.064483642578125,0.61151123046875,-0.290557861328125,0.8709564208984375,-0.16790771484375,0.3526153564453125,-0.344451904296875,0.976043701171875,0.111419677734375,-0.9369964599609375,-0.1169281005859375,0.1761474609375,0.3183135986328125,-0.7149505615234375,-0.75750732421875,-0.672760009765625,-0.004425048828125,-0.2299346923828125,-0.0449066162109375,-0.380523681640625,0.55560302734375,0.896270751953125,0.69830322265625,-0.2530670166015625,0.43890380859375,0.818084716796875,0.08282470703125,-0.5470428466796875,-0.9037628173828125,0.7197265625,-0.49505615234375,-0.28033447265625,0.3059539794921875,0.415802001953125,0.616912841796875,0.1464080810546875,-0.74591064453125,-0.276947021484375,0.7305450439453125,0.648773193359375,0.533294677734375,0.52130126953125,-0.6456756591796875,-0.488922119140625,-0.242218017578125,-0.7711639404296875,0.76104736328125,-0.9624481201171875,-0.1554412841796875,-0.4640045166015625,0.9930877685546875,-0.426971435546875,0.17803955078125,0.6728363037109375,-0.9653167724609375,0.5020294189453125,0.852783203125,-0.76934814453125,-0.9846954345703125,0.985076904296875,0.980621337890625},{0.6138153076171875,-0.744659423828125,-0.3455047607421875,-0.34814453125,-0.43243408203125,0.725250244140625,-0.7332763671875,0.5563201904296875,-0.090972900390625,0.061737060546875,-0.6031646728515625,0.498138427734375,-0.417144775390625,0.6687164306640625,-0.33941650390625,0.079864501953125,0.469451904296875,-0.3711395263671875,-0.33734130859375,-0.3156890869140625,0.9930877685546875,0.16058349609375,-0.104949951171875,-0.450958251953125,-0.491302490234375,-0.8218536376953125,0.1474151611328125,-0.7932891845703125,-0.3098602294921875,-0.853118896484375,0.6416015625,0.8555755615234375,-0.3001251220703125,0.87310791015625,0.0654296875,-0.67218017578125,0.7884063720703125,-0.8719940185546875,-0.0436859130859375,0.239654541015625,0.154266357421875,0.076812744140625,0.4730072021484375,-0.364532470703125,-0.611419677734375,0.369720458984375,0.4943695068359375,0.9792327880859375,-0.363983154296875,0.4479827880859375,-0.8033447265625,0.700286865234375,-0.2782745361328125,-0.87158203125,0.78668212890625,-0.334014892578125,-0.0731658935546875,0.85205078125,0.9054412841796875,0.933013916015625,-0.16192626953125,-0.882904052734375,0.3677978515625,-0.08062744140625,-0.2452850341796875,-0.436126708984375,-0.6334686279296875,-0.2567901611328125,-0.4956817626953125,-0.0609893798828125,-0.9560546875,-0.109649658203125,0.2009735107421875,-0.261322021484375,-0.57684326171875,0.6008453369140625,-0.5262908935546875,-0.28497314453125,-0.9095306396484375,0.4062652587890625,0.999267578125,0.627685546875,0.7338409423828125,0.102447509765625,0.792755126953125,-0.36834716796875,-0.332305908203125,-0.891265869140625,-0.358856201171875,-0.4848480224609375,-0.188018798828125,-0.3565826416015625,-0.69110107421875,0.63616943359375,-0.7558746337890625,0.43560791015625,-0.29833984375,-0.146881103515625,-0.594940185546875,0.797821044921875},{-0.957183837890625,-0.99468994140625,0.3162384033203125,-0.2008819580078125,-0.700347900390625,-0.4292144775390625,0.7522430419921875,0.0075225830078125,0.589935302734375,0.0142822265625,-0.786163330078125,0.811309814453125,-0.8937225341796875,0.0347900390625,0.75970458984375,0.6820220947265625,-0.785247802734375,-0.567474365234375,0.2799530029296875,0.90869140625,-0.1838226318359375,0.636993408203125,0.632568359375,-0.68939208984375,-0.1977996826171875,-0.92724609375,0.2146148681640625,-0.77264404296875,-0.5047760009765625,0.4865875244140625,-0.99749755859375,0.6884307861328125,0.3303070068359375,-0.8799896240234375,0.8712158203125,-0.9196624755859375,-0.2811431884765625,-0.8173828125,-0.9097137451171875,-0.14190673828125,0.02783203125,0.467132568359375,-0.70526123046875,-0.1112823486328125,-0.0847930908203125,-0.8559722900390625,-0.0580291748046875,0.868072509765625,0.8812408447265625,0.78326416015625,0.29095458984375,-0.082000732421875,-0.1730804443359375,0.4733123779296875,0.27825927734375,0.9499359130859375,-0.344970703125,0.541900634765625,-0.684539794921875,-0.32867431640625,0.50592041015625,-0.1693572998046875,-0.00439453125,-0.784454345703125,0.089324951171875,-0.2647857666015625,-0.02825927734375,0.29119873046875,0.75494384765625,-0.70501708984375,0.8584442138671875,-0.5239410400390625,-0.56103515625,0.50103759765625,0.90740966796875,-0.1789093017578125,0.43011474609375,-0.311492919921875,0.4216156005859375,-0.715850830078125,0.0180511474609375,-0.6109619140625,-0.6026153564453125,0.67864990234375,0.5185546875,-0.658660888671875,-0.2781982421875,-0.198974609375,0.914093017578125,-0.507080078125,-0.59649658203125,0.1920013427734375,0.4050445556640625,-0.2272796630859375,-0.2227020263671875,-0.4100494384765625,-0.4642333984375,-0.8251190185546875,0.3991546630859375,0.5507965087890625},{-0.7581787109375,0.26544189453125,0.4350128173828125,-0.0624237060546875,-0.8417510986328125,0.6091156005859375,-0.251556396484375,-0.9766693115234375,0.8356781005859375,-0.18994140625,-0.3961334228515625,-0.195037841796875,-0.8695220947265625,-0.129180908203125,-0.071441650390625,-0.2083892822265625,-0.0338287353515625,-0.6046600341796875,-0.5864410400390625,-0.9905548095703125,0.9080810546875,0.7972869873046875,0.3847503662109375,-0.744232177734375,0.5493621826171875,0.12164306640625,0.337860107421875,0.7393951416015625,-0.423828125,-0.65228271484375,0.3066558837890625,-0.8407135009765625,0.560791015625,-0.8862457275390625,0.821441650390625,-0.996978759765625,-0.9738006591796875,-0.3118438720703125,-0.884613037109375,0.3868255615234375,-0.86798095703125,-0.290374755859375,0.44921875,-0.88702392578125,-0.549346923828125,-0.271728515625,-0.050018310546875,0.786041259765625,-0.2653350830078125,0.90185546875,-0.8024749755859375,-0.19171142578125,0.31988525390625,0.336517333984375,-0.057098388671875,0.8650665283203125,-0.134002685546875,-0.491943359375,-0.1941986083984375,0.1152496337890625,0.505035400390625,0.9600677490234375,-0.4270477294921875,-0.2829437255859375,0.15020751953125,-0.9528656005859375,0.8083038330078125,0.54864501953125,-0.2888031005859375,0.8763885498046875,-0.114776611328125,0.0236053466796875,0.2693939208984375,-0.20233154296875,0.2644805908203125,0.7550811767578125,-0.1152801513671875,-0.19732666015625,0.86688232421875,-0.51165771484375,-0.3616485595703125,-0.9847869873046875,0.727386474609375,0.19989013671875,-0.2410888671875,0.0900726318359375,0.76788330078125,0.5525054931640625,-0.762939453125,0.78485107421875,0.488922119140625,0.9990997314453125,0.2020111083984375,-0.771148681640625,0.6556396484375,0.7438201904296875,-0.4846954345703125,-0.514190673828125,0.6413726806640625,0.49822998046875},{0.5317230224609375,-0.108551025390625,0.992919921875,0.5104217529296875,-0.21697998046875,-0.6554412841796875,-0.0062408447265625,-0.3007659912109375,0.4601593017578125,-0.760223388671875,-0.472320556640625,-0.108673095703125,-0.999176025390625,-0.9471893310546875,0.38250732421875,0.13739013671875,0.8332977294921875,-0.276763916015625,0.2843017578125,-0.12493896484375,0.384552001953125,0.9274444580078125,-0.5846099853515625,0.3094024658203125,0.8291778564453125,0.0943603515625,-0.0551605224609375,0.79779052734375,0.7379913330078125,0.588287353515625,0.1876373291015625,-0.7452850341796875,-0.221343994140625,-0.1317291259765625,0.409881591796875,0.6329498291015625,-0.0721893310546875,-0.3690948486328125,0.00946044921875,-0.6089019775390625,0.27301025390625,0.952667236328125,0.8275299072265625,0.523406982421875,0.414703369140625,0.2706146240234375,0.6839752197265625,-0.7935638427734375,-0.2777557373046875,0.6750030517578125,0.8800048828125,-0.5918731689453125,-0.7449951171875,-0.565704345703125,-0.625335693359375,0.908172607421875,0.02838134765625,0.933258056640625,-0.38336181640625,0.0948333740234375,-0.5134429931640625,0.276763916015625,-0.39874267578125,0.631866455078125,-0.46246337890625,0.6969146728515625,0.6225433349609375,-0.3700714111328125,0.313140869140625,-0.40191650390625,0.403350830078125,-0.689361572265625,-0.0648345947265625,-0.415252685546875,0.8118438720703125,-0.6823577880859375,0.0013885498046875,0.138458251953125,0.2105560302734375,0.8068084716796875,-0.751800537109375,0.746002197265625,0.634613037109375,0.239776611328125,-0.0956878662109375,-0.77276611328125,0.458526611328125,0.4075469970703125,0.6183929443359375,-0.2286376953125,-0.0133819580078125,0.6275482177734375,0.525421142578125,-0.2374114990234375,0.4896240234375,-0.714111328125,-0.9891815185546875,0.8604888916015625,0.610809326171875,-0.062774658203125},{-0.962371826171875,-0.0015106201171875,-0.2224578857421875,-0.9711456298828125,0.5216522216796875,-0.0274505615234375,0.279754638671875,0.980987548828125,0.17083740234375,-0.8845062255859375,0.0147857666015625,0.83404541015625,-0.550811767578125,-0.8136444091796875,0.548004150390625,-0.03521728515625,0.8825225830078125,0.051849365234375,0.1021881103515625,0.476470947265625,0.792266845703125,0.99664306640625,0.3634033203125,0.78448486328125,-0.2749786376953125,-0.4284515380859375,-0.4206085205078125,0.64703369140625,0.34014892578125,-0.226898193359375,0.3266448974609375,0.4320526123046875,0.323883056640625,0.045989990234375,0.5355224609375,0.764312744140625,-0.9821624755859375,0.1086578369140625,0.8877410888671875,0.86334228515625,0.881317138671875,-0.0744476318359375,0.538909912109375,0.8610687255859375,0.651031494140625,0.2835540771484375,0.2688140869140625,-0.8211822509765625,0.1185302734375,0.37786865234375,-0.3748321533203125,0.6473541259765625,0.814544677734375,-0.427978515625,0.4021453857421875,0.4691925048828125,0.5714111328125,0.0693511962890625,0.8824462890625,-0.648651123046875,0.9286041259765625,0.6176605224609375,-0.3274688720703125,0.1771240234375,0.6533203125,0.5662994384765625,0.67315673828125,0.4398651123046875,0.2667694091796875,0.60455322265625,-0.2469940185546875,-0.673248291015625,-0.600830078125,-0.66748046875,-0.969024658203125,-0.1801300048828125,-0.9603424072265625,-0.549591064453125,0.322998046875,0.4726104736328125,0.30487060546875,-0.20037841796875,-0.7275848388671875,0.622650146484375,0.2185516357421875,-0.251678466796875,-0.0419769287109375,0.719482421875,-0.8238525390625,0.486968994140625,0.361968994140625,0.17218017578125,0.2630157470703125,-0.3162078857421875,-0.019989013671875,0.664703369140625,-0.59918212890625,-0.3525848388671875,0.0697174072265625,-0.760711669921875},{-0.5836181640625,0.6536102294921875,0.557098388671875,0.6145172119140625,0.5586090087890625,0.4157867431640625,-0.5392303466796875,0.1831512451171875,0.7333221435546875,-0.1871337890625,0.842315673828125,-0.0739593505859375,0.7825469970703125,-0.0636749267578125,-0.244720458984375,-0.918426513671875,-0.496337890625,0.277099609375,-0.5601806640625,-0.173553466796875,-0.213958740234375,0.446014404296875,-0.9016265869140625,-0.5480804443359375,-0.763824462890625,0.205780029296875,-0.011810302734375,0.560821533203125,-0.0303802490234375,0.7899169921875,-0.72113037109375,-0.33612060546875,0.8667755126953125,0.493865966796875,-0.8506011962890625,0.2203369140625,-0.47857666015625,-0.6544189453125,0.9358978271484375,0.6458892822265625,0.3549346923828125,-0.7020263671875,0.7928466796875,-0.8976898193359375,-0.0743255615234375,-0.1674346923828125,0.2925262451171875,0.9866790771484375,0.332550048828125,0.123626708984375,0.663360595703125,-0.04632568359375,0.7928619384765625,-0.0158233642578125,0.9554595947265625,-0.9663848876953125,-0.0308837890625,0.7003631591796875,0.3222503662109375,0.9493865966796875,-0.5740203857421875,-0.442535400390625,0.8197479248046875,0.089111328125,-0.282501220703125,0.3709716796875,-0.3494110107421875,0.757476806640625,-0.963165283203125,0.6583709716796875,0.6177825927734375,-0.6929473876953125,0.104248046875,0.2216796875,-0.29644775390625,-0.4579010009765625,0.0263824462890625,-0.1413726806640625,-0.8486175537109375,-0.6094512939453125,0.22845458984375,0.6796875,0.2050933837890625,0.2563629150390625,-0.756866455078125,0.080596923828125,0.74627685546875,0.6925811767578125,0.1334075927734375,-0.1952667236328125,0.472015380859375,-0.92364501953125,0.634002685546875,0.727081298828125,0.9679107666015625,-0.1787109375,-0.28515625,0.0010986328125,-0.943756103515625,0.327850341796875},{-0.798828125,-0.967681884765625,-0.8623504638671875,-0.6487579345703125,-0.6698150634765625,-0.6231536865234375,-0.105316162109375,-0.24237060546875,0.679443359375,0.1109161376953125,0.6884918212890625,-0.2576446533203125,-0.2275238037109375,0.476531982421875,-0.744415283203125,0.50048828125,-0.15203857421875,-0.3187713623046875,0.89923095703125,-0.93194580078125,-0.2266387939453125,-0.3856658935546875,0.2703857421875,0.5937957763671875,0.890411376953125,-0.06036376953125,0.0463714599609375,0.654205322265625,-0.300994873046875,0.5337982177734375,0.34027099609375,-0.6087646484375,-0.282318115234375,-0.437469482421875,0.5125885009765625,-0.76971435546875,0.603057861328125,0.6210174560546875,-0.7935638427734375,0.7269134521484375,0.6671600341796875,-0.687652587890625,0.8909912109375,0.6946258544921875,0.3007965087890625,0.397735595703125,-0.0269927978515625,-0.8181304931640625,0.4926910400390625,-0.7757415771484375,0.6240692138671875,-0.905120849609375,0.628387451171875,-0.47918701171875,-0.1280975341796875,0.304168701171875,-0.9407501220703125,-0.149810791015625,-0.7833709716796875,0.9257049560546875,0.5514678955078125,-0.985137939453125,0.0585174560546875,0.1343536376953125,0.656280517578125,0.5366058349609375,0.5615386962890625,-0.65509033203125,0.2868804931640625,-0.035614013671875,0.22735595703125,-0.1121826171875,0.34405517578125,0.21270751953125,-0.582489013671875,-0.5902252197265625,0.101959228515625,-0.6079254150390625,0.3366851806640625,0.145416259765625,0.24676513671875,0.6654815673828125,-0.4220733642578125,-0.064910888671875,-0.0448150634765625,0.5498809814453125,0.23126220703125,-0.5957183837890625,-0.793304443359375,0.77838134765625,-0.230316162109375,0.0744476318359375,0.6421966552734375,-0.6506805419921875,0.452178955078125,0.340057373046875,-0.286651611328125,0.709930419921875,-0.1787109375,-0.773651123046875},{-0.3884124755859375,-0.84234619140625,0.0229034423828125,-0.3677825927734375,0.5216522216796875,-0.5109100341796875,0.1391754150390625,-0.6332244873046875,-0.8858184814453125,0.68646240234375,-0.4993896484375,-0.295806884765625,-0.1265869140625,0.0037384033203125,0.03131103515625,-0.5904541015625,0.8499908447265625,0.199188232421875,0.0818328857421875,-0.7703704833984375,0.73583984375,-0.14117431640625,0.9170379638671875,-0.3035888671875,-0.22308349609375,-0.235809326171875,0.0513916015625,-0.24359130859375,-0.0285491943359375,-0.9189300537109375,0.9625396728515625,-0.7819366455078125,0.245361328125,-0.220062255859375,0.36395263671875,0.3001556396484375,-0.1467132568359375,0.146270751953125,0.1806182861328125,0.6678314208984375,0.12255859375,0.49884033203125,-0.3530426025390625,0.2585906982421875,0.8394927978515625,0.3061981201171875,-0.465911865234375,0.9296417236328125,-0.9290618896484375,-0.2237091064453125,-0.5858612060546875,-0.50164794921875,-0.978607177734375,0.6915435791015625,0.08172607421875,-0.898345947265625,-0.3555755615234375,0.7714996337890625,0.7787322998046875,0.96588134765625,0.1591339111328125,-0.8327789306640625,0.705902099609375,0.657257080078125,0.3668212890625,-0.1733551025390625,0.4553375244140625,-0.326019287109375,0.718780517578125,0.4170379638671875,-0.538970947265625,0.8449859619140625,0.4563446044921875,-0.7490081787109375,0.3395538330078125,0.4154510498046875,0.8251800537109375,-0.7660980224609375,0.08160400390625,0.92889404296875,0.3602447509765625,0.2364349365234375,-0.54559326171875,-0.944488525390625,0.5445404052734375,-0.5077362060546875,-0.310699462890625,-0.629119873046875,0.763763427734375,-0.368927001953125,-0.4472808837890625,0.7545013427734375,-0.58929443359375,-0.220458984375,0.237884521484375,0.5566253662109375,-0.7626495361328125,0.79736328125,0.164337158203125,0.9724884033203125},{-0.3907012939453125,-0.8372802734375,0.7350921630859375,0.1667633056640625,0.1862335205078125,-0.718475341796875,-0.6225128173828125,-0.3927764892578125,-0.2661895751953125,-0.933013916015625,-0.2194366455078125,0.7945709228515625,0.266510009765625,0.520538330078125,-0.856903076171875,-0.882843017578125,0.5276031494140625,-0.2570953369140625,0.4589080810546875,-0.0879058837890625,-0.06842041015625,-0.6865081787109375,0.391326904296875,-0.0190887451171875,0.5259246826171875,0.2985687255859375,0.1269683837890625,0.785980224609375,0.2733001708984375,-0.716217041015625,-0.2508392333984375,-0.6549835205078125,0.012054443359375,-0.226593017578125,0.134124755859375,-0.5551605224609375,0.821624755859375,-0.9412841796875,0.1485137939453125,-0.788909912109375,0.2015838623046875,-0.769775390625,-0.9848480224609375,-0.7006072998046875,0.4669647216796875,0.3930206298828125,0.113372802734375,-0.985504150390625,-0.931121826171875,-0.6580810546875,-0.805755615234375,-0.4827423095703125,0.1693572998046875,-0.03704833984375,-0.9844970703125,-0.0543670654296875,-0.2701263427734375,0.4496002197265625,-0.2604827880859375,-0.2461700439453125,0.6183624267578125,-0.94244384765625,0.0875701904296875,0.8656463623046875,-0.204864501953125,0.5684967041015625,0.20697021484375,0.3406219482421875,0.5078582763671875,-0.106597900390625,-0.5173187255859375,0.1681060791015625,0.60736083984375,-0.6816864013671875,-0.8869781494140625,-0.4669189453125,-0.4102630615234375,-0.2202911376953125,0.169647216796875,0.4380035400390625,-0.22259521484375,0.2546844482421875,-0.9254150390625,-0.0810546875,-0.829376220703125,0.86016845703125,-0.0472564697265625,-0.7399444580078125,0.932647705078125,0.5781097412109375,-0.8440704345703125,0.58905029296875,-0.7842864990234375,-0.3418121337890625,-0.5947418212890625,0.02734375,-0.9078369140625,-0.3030548095703125,-0.5388946533203125,0.1719512939453125},{-0.276458740234375,-0.848114013671875,0.0057373046875,-0.8976287841796875,0.5824127197265625,0.6212921142578125,-0.488739013671875,0.3341064453125,0.5361480712890625,0.6057586669921875,-0.7339324951171875,0.181640625,0.90765380859375,0.663909912109375,0.445831298828125,-0.1530609130859375,0.2483367919921875,0.88525390625,0.1404876708984375,-0.784271240234375,0.4891357421875,0.425079345703125,-0.4134368896484375,-0.17742919921875,-0.619659423828125,-0.519073486328125,0.504486083984375,-0.263946533203125,0.6872100830078125,0.537811279296875,0.403594970703125,-0.7802581787109375,-0.5222625732421875,-0.03118896484375,0.99273681640625,0.9401397705078125,-0.9797821044921875,0.149993896484375,-0.5775146484375,0.22125244140625,0.3029327392578125,-0.8664703369140625,-0.0149078369140625,-0.61309814453125,0.994384765625,-0.3799896240234375,0.1114654541015625,-0.415130615234375,-0.2179718017578125,-0.5193939208984375,-0.9702606201171875,-0.3465728759765625,0.4588165283203125,0.4024505615234375,0.287750244140625,0.5689697265625,-0.1287078857421875,-0.6353302001953125,0.4925079345703125,-0.195159912109375,0.8994140625,-0.3995208740234375,0.082122802734375,0.5345458984375,0.007293701171875,-0.5399322509765625,-0.27850341796875,0.0289459228515625,0.586151123046875,-0.83868408203125,7.9345703125E-4,-0.1747283935546875,0.304534912109375,0.8004302978515625,0.5159454345703125,-0.7130279541015625,0.9873809814453125,0.191497802734375,-0.8763427734375,0.0269317626953125,-0.8348541259765625,0.1138153076171875,-0.81146240234375,-0.667755126953125,0.3654632568359375,-0.631500244140625,-0.022125244140625,0.2080841064453125,0.4640045166015625,0.67987060546875,-0.989837646484375,-0.051910400390625,0.9678497314453125,0.925201416015625,-0.8739471435546875,0.2433013916015625,-0.02593994140625,-0.5643310546875,-0.673828125,-0.243194580078125},{0.7273712158203125,0.1837158203125,-0.9921722412109375,0.8205413818359375,-0.8046112060546875,-0.443115234375,0.1331634521484375,-0.549041748046875,0.88616943359375,-0.8845977783203125,-0.9258270263671875,0.2344207763671875,-0.747711181640625,0.240570068359375,-0.5945281982421875,0.798858642578125,-0.542999267578125,0.9032135009765625,0.753326416015625,0.5667266845703125,0.0224456787109375,-0.0836334228515625,0.9603118896484375,-0.7243804931640625,0.9362335205078125,0.983367919921875,-0.7126312255859375,0.355865478515625,0.1622314453125,-0.3873291015625,-0.8493194580078125,0.6712799072265625,-0.8175201416015625,0.542572021484375,-0.021270751953125,-0.643310546875,0.1921234130859375,-0.29583740234375,-0.8249053955078125,0.5278778076171875,0.8748626708984375,0.9476318359375,0.885498046875,-0.507537841796875,-0.693511962890625,-0.2325286865234375,0.293212890625,-0.2434539794921875,-0.534820556640625,0.08367919921875,0.5045318603515625,0.6002960205078125,-0.92852783203125,-0.228668212890625,-0.2635955810546875,0.2867431640625,0.0377349853515625,0.077972412109375,-0.5182647705078125,0.0717620849609375,-0.32452392578125,-0.6720123291015625,-0.397705078125,-0.90130615234375,-0.0086822509765625,0.38555908203125,-0.11175537109375,-0.0097198486328125,0.895904541015625,0.2322998046875,-0.477569580078125,-0.5090484619140625,0.956878662109375,0.7133636474609375,0.10174560546875,-0.133392333984375,0.44647216796875,0.0150299072265625,0.3920440673828125,0.9344329833984375,-0.1346282958984375,0.7594757080078125,-0.167999267578125,-0.4256439208984375,0.869110107421875,0.7371368408203125,0.951019287109375,-0.63543701171875,-0.4202880859375,0.2440032958984375,0.3295135498046875,-0.4132537841796875,0.634368896484375,-0.2485809326171875,-0.494842529296875,0.263214111328125,0.0047607421875,-0.7919921875,-0.683380126953125,0.116363525390625},{-0.3853912353515625,-0.3420257568359375,-0.4232940673828125,-0.61834716796875,-0.910308837890625,-0.94256591796875,0.67974853515625,-0.7405242919921875,-0.406097412109375,-0.8195343017578125,0.773284912109375,0.456512451171875,-0.363616943359375,-0.6718902587890625,-0.5377044677734375,0.74639892578125,0.978729248046875,-0.81072998046875,0.6642913818359375,-0.230010986328125,0.328460693359375,-0.3512420654296875,-0.8032073974609375,0.399444580078125,-0.6264801025390625,0.598358154296875,-0.0462493896484375,-0.093994140625,-0.1055450439453125,0.878387451171875,-0.884246826171875,0.9001922607421875,0.1851959228515625,-0.6375885009765625,-0.2611541748046875,-0.446136474609375,-0.1803741455078125,-0.105224609375,-0.7199249267578125,0.9673919677734375,-0.079315185546875,0.3006591796875,0.1429595947265625,0.7109222412109375,-0.4798583984375,-0.9896697998046875,0.164093017578125,-0.4526519775390625,-0.65863037109375,-0.025848388671875,0.1125030517578125,-0.8640899658203125,0.3940277099609375,-0.507659912109375,-0.2636871337890625,0.1180572509765625,0.1389007568359375,-0.657135009765625,0.6664276123046875,0.404388427734375,-0.3374176025390625,-0.83636474609375,-0.424896240234375,0.708831787109375,-0.7040863037109375,-0.5707244873046875,0.3876190185546875,0.4180145263671875,-0.5833587646484375,0.5607147216796875,0.0579986572265625,-0.262939453125,-0.2038116455078125,-0.28497314453125,0.4451751708984375,-0.281036376953125,0.7815399169921875,0.625579833984375,-0.835845947265625,0.263336181640625,0.848052978515625,-0.5028533935546875,0.9365997314453125,-0.538665771484375,-0.385040283203125,-0.592041015625,-0.0713653564453125,-0.233062744140625,-0.714874267578125,0.9304351806640625,0.8389434814453125,-0.6090087890625,0.651641845703125,-0.2454833984375,0.087738037109375,-0.9571533203125,0.3085174560546875,0.9825286865234375,0.3582305908203125,0.685272216796875},{-0.4909515380859375,0.461456298828125,-0.04547119140625,0.3221588134765625,0.2345428466796875,0.0283660888671875,0.9657135009765625,-0.9956817626953125,0.4681243896484375,-0.1326751708984375,-0.9365997314453125,-0.78277587890625,0.41192626953125,-0.6896820068359375,0.9106292724609375,-0.3944244384765625,0.44305419921875,-0.6376190185546875,0.623016357421875,-0.40673828125,-0.0273284912109375,-0.00909423828125,0.49798583984375,0.872833251953125,0.05419921875,0.79107666015625,-0.6836090087890625,0.9678497314453125,-0.4193267822265625,-0.975616455078125,-0.0792388916015625,-0.8884124755859375,-0.7816925048828125,0.2244110107421875,0.4874267578125,0.540008544921875,0.8419189453125,-0.426177978515625,0.9355010986328125,-0.037811279296875,-0.830078125,-0.92144775390625,-0.747161865234375,0.4503173828125,0.540618896484375,0.200439453125,0.170379638671875,0.2823486328125,-0.671905517578125,0.056304931640625,0.5784912109375,-0.6263427734375,-0.6348114013671875,-0.4485626220703125,0.3546295166015625,0.8505401611328125,-0.07733154296875,-0.111968994140625,-0.140594482421875,0.0462188720703125,-0.7119293212890625,-0.226898193359375,0.2587432861328125,0.741943359375,-0.206207275390625,-0.6513519287109375,0.0422821044921875,0.8282318115234375,0.2637481689453125,0.3757171630859375,0.6341705322265625,0.7283782958984375,-0.7208251953125,-0.4729766845703125,-0.1703338623046875,-0.0960235595703125,-0.5914764404296875,0.7768096923828125,-0.0582427978515625,-0.446136474609375,0.6027374267578125,-0.1753082275390625,0.0048828125,-0.7791290283203125,0.3267059326171875,0.2492828369140625,0.1579132080078125,-0.5626068115234375,0.6790771484375,-0.33990478515625,-0.58319091796875,-0.23126220703125,0.746795654296875,0.5009918212890625,-0.552337646484375,-0.3455963134765625,-0.2524566650390625,0.355194091796875,0.663421630859375,0.3013153076171875},{-0.8679962158203125,0.61248779296875,0.9935455322265625,-0.4515228271484375,-0.2498931884765625,0.1807708740234375,0.0132293701171875,0.101287841796875,-0.571044921875,0.559173583984375,-0.2305908203125,0.8250885009765625,0.867095947265625,0.0372772216796875,0.6038055419921875,0.890350341796875,-0.3810272216796875,0.0447235107421875,-0.4516754150390625,-0.5214080810546875,-0.8751983642578125,-0.2525482177734375,0.456298828125,-0.5138397216796875,0.2355499267578125,-0.1277923583984375,0.9334564208984375,0.2042999267578125,0.489013671875,-0.5624847412109375,-0.6550140380859375,-0.692626953125,-0.487518310546875,-0.42047119140625,-0.2988433837890625,0.647003173828125,-0.6412811279296875,0.9834442138671875,-0.9389190673828125,-0.671356201171875,0.3265533447265625,-0.434417724609375,-0.754791259765625,-0.6622161865234375,-0.126312255859375,0.9988555908203125,0.109710693359375,-0.4130401611328125,0.598663330078125,0.4340057373046875,-0.5886688232421875,-0.3297119140625,0.9503631591796875,-0.658935546875,0.3792724609375,0.8409576416015625,-0.6821136474609375,0.78070068359375,0.5110321044921875,0.76837158203125,0.4599151611328125,-0.388153076171875,-0.1780242919921875,0.484649658203125,0.8520965576171875,-0.8478851318359375,-0.1962127685546875,0.5965576171875,0.4625244140625,0.62969970703125,-0.315032958984375,-0.68255615234375,0.7094268798828125,0.4003448486328125,0.2367401123046875,-0.8353118896484375,-0.087921142578125,0.3497161865234375,-0.6691436767578125,0.2715606689453125,0.4146881103515625,-0.8378448486328125,-0.26910400390625,0.178741455078125,-0.2547760009765625,0.2081146240234375,0.1868133544921875,0.6988677978515625,-0.335418701171875,-0.311920166015625,-0.1972198486328125,-0.0110931396484375,-0.2311248779296875,0.367645263671875,0.8611602783203125,0.3182830810546875,0.4260406494140625,-0.2517242431640625,0.8109283447265625,-0.8131103515625}};

		Matrice M1 = new Matrice(m1);

		double[] a1 = {-0.4004669189453125,0.2458343505859375,0.409881591796875,-0.4720611572265625,-0.0824737548828125,-0.3102264404296875,0.1744842529296875,0.107452392578125,0.492645263671875,-0.420806884765625,0.615997314453125,1.430267333984375,-0.348419189453125,-0.0941619873046875,-1.019439697265625,-0.4713592529296875,-0.2584686279296875,-0.2645416259765625,-0.05059814453125,0.855133056640625};
		Array A2 = new Array(a1);

		Array Q1 = HomotopyFP.SolveHomotopy(M1, A2);

		//System.out.println("Estimated X");
		System.out.print("x1 = [");
		Q1.printArray();
		System.out.println("];");
		System.out.println("plot( x1, 'b')");
	}

	// generates a random Matrice M1 and sparse vector A1
	// computes A2 = M1*A1;
	// solves L1 using A2 and M1.  
	// computes the l1 norm diff between output of Homotopy and A1.
	public static void test2(){
		Random rand = new Random();
		int m = 50;
		int n = 200;
		int[][] m1 = new int[m][n];
		int[] a1 = new int[n];  // x0 ground truth

		for(int i= 0; i < m; i++){
			for(int j = 0; j < n; j++){
				m1[i][j] = FPMath.FloatToFP(rand.nextDouble()*2-1);
			}
		}
		int temp = 0;
		for(int i = 0 ; i < 5; i++){
			temp = (temp + rand.nextInt(a1.length))%100;
			a1[temp] = FPMath.FPMul(FPMath.IntToFP(rand.nextInt(10)), FPMath.IntToFP(1));
		}

		Matrice M1 = new Matrice(m1);
		Array A1 = new Array(a1);  // ground truth
		
		A1.normalize();
		
		Array A2 = M1.times(A1);
		int[] a2 = A2.getArray(); // projected vector


		//System.out.println("ANSWER");
		Array Q1 = HomotopyFP.SolveHomotopy(M1, A2);

		float norm1diff = 0;
		for(int i = 0 ; i < Q1.getLength(); i++){
			norm1diff += Math.abs(FPMath.FPToFloat(Q1.getElement(i))-FPMath.FPToFloat(A1.getElement(i)));
		}
		

		if(norm1diff > 1.0){

			System.out.println("norm1diff " + norm1diff);
			
			System.out.println("MATLAB");
			printToMatlab(m1);
			printToMatlab(a2);
			System.out.println("JAVA");
			printToJava(m1);
			printToJava(a2);

			//System.out.println("Ground Truth");
			System.out.print("x0 = [");
			A1.printArray();
			System.out.println("];");
			//System.out.println("Estimated X");
			System.out.print("x1 = [");
			Q1.printArray();
			System.out.println("];");
			System.out.println("hold on; plot(x0, 'r'); plot( x1, 'b')");

		}
	}

	// runs test2 10,100,1000 times
	public static void main(String[] args){
		//test2();
		Calendar cal = Calendar.getInstance();
		long start = cal.getTimeInMillis();
		for(int i = 0 ; i < 10; i++){
			test2();
		}
		cal = Calendar.getInstance();
		long elapsed = cal.getTimeInMillis() - start;
		System.out.println("Run Homotopy 10 times takes " + (elapsed) + " milliseconds");

		start = cal.getTimeInMillis();
		for(int i = 0 ; i < 100; i++){
			test2();
		}
		cal = Calendar.getInstance();
		elapsed = cal.getTimeInMillis() - start;
		System.out.println("Run Homotopy 100 times takes " + (elapsed) + " milliseconds");

		start = cal.getTimeInMillis();
		for(int i = 0 ; i < 1000; i++){
			test2();
		}
		cal = Calendar.getInstance();
		elapsed = cal.getTimeInMillis() - start;
		System.out.println("Run Homotopy 1000 times takes " + (elapsed) + " milliseconds");
	}

	public static void printToJava(int[][] m1){
		System.out.print("int[][] m1 = {");
		for(int i = 0; i < m1.length; i++){
			if (i != 0 )
				System.out.print(",");
			System.out.print("{");

			for(int j = 0; j < m1[0].length; j++){
				if (j!=0)
					System.out.print(",");
				System.out.print(FPMath.FPToFloat(m1[i][j]));
			}

			System.out.print("}");
		}
		System.out.println("};");
	}


	public static void printToJava(int[] a1){
		System.out.print("int[] a1 = {");
		for(int i = 0; i < a1.length; i++){
			if (i != 0 )
				System.out.print(",");
			System.out.print(FPMath.FPToFloat(a1[i]));
		}
		System.out.println("};");
	}

	public static void printToMatlab(int[][] m1){
		System.out.print("A = [");
		for(int i = 0; i < m1.length; i++){
			if (i != 0 )
				System.out.print(";");
			for(int j = 0; j < m1[0].length; j++){
				if (j!=0)
					System.out.print(",");
				System.out.print(FPMath.FPToFloat(m1[i][j]));
			}
		}
		System.out.println("]");
	}

	public static void printToMatlab(int[] a1){
		System.out.print("y = [");
		for(int i = 0; i < a1.length; i++){
			if (i != 0 )
				System.out.print(";");
			System.out.print(FPMath.FPToFloat(a1[i]));
		}
		System.out.println("]");
	}
}
